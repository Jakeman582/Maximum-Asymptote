///////////////////////////////////////////////////////////////////////////////////////////////////
// Library imports
///////////////////////////////////////////////////////////////////////////////////////////////////
import graph;

///////////////////////////////////////////////////////////////////////////////////////////////////
// Maximum Mathematics import
///////////////////////////////////////////////////////////////////////////////////////////////////
import MaximumMathematics;

///////////////////////////////////////////////////////////////////////////////////////////////////
// Figure settings
///////////////////////////////////////////////////////////////////////////////////////////////////
unitsize(1cm);

///////////////////////////////////////////////////////////////////////////////////////////////////
// Image settings
///////////////////////////////////////////////////////////////////////////////////////////////////
real width = 5;
real height = 5;
real margin = 0.1;

///////////////////////////////////////////////////////////////////////////////////////////////////
// Caption settings
///////////////////////////////////////////////////////////////////////////////////////////////////
real caption_height = 1;
bool include_caption = false;

///////////////////////////////////////////////////////////////////////////////////////////////////
// Drawing the image
///////////////////////////////////////////////////////////////////////////////////////////////////
picture background;
picture image;

// Color in the background, including space for the margin
fill(
    background,
    box((-margin, -margin), (width + margin, height + margin)),
    p = figure_background_color
);

// Setting the graphing window
PlotWindow plot_window = PlotWindow(
    -3.0, 5.0,
    -3.0, 5.0, 
    width, height
);

// Plotting graph elements
draw_x_axis(image, plot_window);
draw_x_ticks(image, plot_window);
draw_y_axis(image, plot_window);
draw_y_ticks(image, plot_window);

real f(real x) {return x;}
draw_real_function(image, plot_window, f);
clip(image, box((0, 0), (plot_window.window_width, plot_window.window_height)));

///////////////////////////////////////////////////////////////////////////////////////////////////
// Drawing the caption
///////////////////////////////////////////////////////////////////////////////////////////////////
picture caption;

// Drawing the background for the caption, including space for the margin
fill(
    caption,
    box((-margin, -margin - caption_height), (width + margin, -margin)),
    p = figure_background_color
);

///////////////////////////////////////////////////////////////////////////////////////////////////
// Producing the final image
///////////////////////////////////////////////////////////////////////////////////////////////////
add(background);
add(image);
if(include_caption) {add(caption);}